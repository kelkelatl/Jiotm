name: Android CI - Build Debug APK

# 1. Trigger the workflow
on:
  workflow_dispatch:

# 2. Define the jobs (what to do)
jobs:
  build:
    runs-on: ubuntu-latest
    
    # Define the environment variables for SDK and build tools
    env:
      # Use a recent Android SDK version
      ANDROID_SDK_ROOT: ${{ github.workspace }}/.android/sdk
      ANDROID_BUILD_TOOLS: 34.0.0 # Match your targetSdk from build.gradle.kts
      
    steps:
      # a. Checkout the code
      - name: Checkout Repository
        uses: actions/checkout@v4

      # b. Use the official Gradle Action to set up Java, the Gradle environment, and caching
      - name: Setup Gradle
        uses: gradle/actions/setup-gradle@v3 # Use the action specific for Gradle setup

      # c. Build the Debug APK (No need for manual chmod +x anymore)
      - name: Build Debug APK
        run: ./gradlew assembleDebug

      # e. Upload the resulting APK as a workflow artifact
      # This allows you to download the APK directly from the GitHub Actions run summary.
      - name: Upload Debug APK Artifact
        uses: actions/upload-artifact@v4
        with:
          # The path to your built APK (adjust if your module name is different)
          path: app/build/outputs/apk/debug/app-debug.apk
          name: Emoticon-App-Debug-APK
          retention-days: 5 # How long to keep the artifact
