package dev.kelvinwilliams.PRE

import android.app.PendingIntent
import android.appwidget.AppWidgetManager
import android.appwidget.AppWidgetProvider
import android.content.Context
import android.content.Intent
import android.util.Log
import android.widget.RemoteViews
import kotlin.random.Random // Required import for Random class

class EmoticonAppWidget : AppWidgetProvider() {

    // --- CLASS PROPERTIES ---
	private val emoString = "ğŸ˜€ğŸ˜ƒğŸ˜„ğŸ˜ğŸ˜†ğŸ˜…ğŸ˜‚ğŸ¤£ğŸ˜­ğŸ˜‰ğŸ˜—ğŸ˜™ğŸ˜šğŸ˜˜ğŸ¥°ğŸ˜ğŸ¤©ğŸ¥³ğŸ« ğŸ™ƒğŸ™‚ğŸ¥²ğŸ¥¹ğŸ˜Šâ˜ºï¸ğŸ˜ŒğŸ˜ğŸ¤¤ğŸ˜‹ğŸ˜›ğŸ˜ğŸ˜œğŸ¤ªğŸ¥´ğŸ˜”ğŸ¥ºğŸ˜¬ğŸ˜‘ğŸ˜ğŸ˜¶ğŸ˜¶â€ğŸŒ«ï¸ğŸ«¥ğŸ¤ğŸ«¡ğŸ¤”ğŸ¤«ğŸ«¢ğŸ¤­ğŸ¥±ğŸ¤—ğŸ«£ğŸ˜±ğŸ¤¨ğŸ§ğŸ˜’ğŸ™„ğŸ˜®â€ğŸ’¨ğŸ˜¤ğŸ˜ ğŸ˜¡ğŸ¤¬ğŸ˜ğŸ˜“ğŸ˜ŸğŸ˜¥ğŸ˜¢â˜¹ï¸ğŸ™ğŸ«¤ğŸ˜•ğŸ˜°ğŸ˜¨ğŸ˜§ğŸ˜¦ğŸ˜®ğŸ˜¯ğŸ˜²ğŸ˜³ğŸ¤¯ğŸ˜–ğŸ˜£ğŸ˜©ğŸ˜«ğŸ˜µğŸ˜µâ€ğŸ’«ğŸ«¨ğŸ¥¶ğŸ¥µğŸ¤¢ğŸ¤®ğŸ˜´ğŸ˜ªğŸ¤§ğŸ¤’ğŸ¤•ğŸ˜·ğŸ¤¥ğŸ˜‡ğŸ¤ ğŸ¤‘ğŸ¤“ğŸ˜ğŸ¥¸ğŸ¤¡ğŸ’©ğŸ˜ˆğŸ‘¿ğŸ‘»ğŸ’€â˜ ï¸ğŸ‘¹ğŸ‘ºâ˜ƒï¸â›„ğŸƒğŸ¤–ğŸ‘½ğŸ‘¾ğŸŒšğŸŒğŸŒğŸŒ›ğŸŒœğŸ˜ºğŸ˜¸ğŸ˜¹ğŸ˜»ğŸ˜¼ğŸ˜½ğŸ™€ğŸ˜¿ğŸ˜¾ğŸ™ˆğŸ™‰ğŸ™ŠğŸ’«â­ğŸŒŸâœ¨âš¡ğŸ’¥ğŸ’¢ğŸ’¨ğŸ’¦ğŸ’¤ğŸ•³ï¸ğŸ”¥ğŸ’¯ğŸ‰ğŸŠâ¤ï¸ğŸ§¡ğŸ’›ğŸ’šğŸ©µğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ©¶ğŸ¤ğŸ©·ğŸ’˜ğŸ’ğŸ’–ğŸ’—ğŸ’“ğŸ’ğŸ’•ğŸ’ŒğŸ’Ÿâ™¥ï¸â£ï¸â¤ï¸â€ğŸ©¹ğŸ’”â¤ï¸â€ğŸ”¥ğŸ’‹ğŸ«‚ğŸ‘¥ğŸ‘¤ğŸ—£ï¸ğŸ‘£ğŸ§ ğŸ«€ğŸ«ğŸ©¸ğŸ¦ ğŸ¦·ğŸ¦´ğŸ‘€ğŸ‘ï¸ğŸ‘„ğŸ«¦ğŸ‘…ğŸ‘ƒğŸ‘‚ğŸ¦»ğŸ¦¶ğŸ¦µğŸ¦¿ğŸ¦¾ğŸ’ªğŸ‘ğŸ‘ğŸ‘ğŸ«¶ğŸ™ŒğŸ‘ğŸ¤²ğŸ¤œğŸ¤›âœŠğŸ‘ŠğŸ«³ğŸ«´ğŸ«±ğŸ«²ğŸ«¸ğŸ«·ğŸ‘‹ğŸ¤šğŸ–ï¸âœ‹ğŸ––ğŸ¤ŸğŸ¤˜âœŒï¸ğŸ¤ğŸ«°ğŸ¤™ğŸ¤ŒğŸ¤ğŸ‘ŒğŸ«µğŸ‘‰ğŸ‘ˆâ˜ï¸ğŸ‘‡ğŸ–•âœï¸ğŸ¤³ğŸ™ğŸ’…ğŸ¤ğŸ™‡ğŸ™‹ğŸ’ğŸ™†ğŸ™…ğŸ¤·ğŸ¤¦ğŸ™ğŸ™ğŸ§ğŸ’†ğŸ’‡ğŸ§–ğŸ›€ğŸ›ŒğŸ§˜ğŸ§ğŸ¤¸ğŸ§ğŸ§‘â€ğŸ¦¼ğŸ§‘â€ğŸ¦½ğŸ§‘â€ğŸ¦¯ğŸš¶ğŸƒâ›¹ï¸ğŸ¤¾ğŸš´ğŸšµğŸ§—ğŸ‹ï¸ğŸ¤¼ğŸ¤¹ğŸŒï¸ğŸ‡ğŸ¤ºâ›·ï¸ğŸ‚ğŸª‚ğŸ„ğŸš£ğŸŠğŸ¤½ğŸ§œğŸ§šğŸ§ğŸ§ğŸ§™ğŸ§›ğŸ§ŸğŸ§ŒğŸ¦¸ğŸ¦¹ğŸ¥·ğŸ§‘â€ğŸ„ğŸ‘¼ğŸ’‚ğŸ«…ğŸ¤µğŸ‘°ğŸ§‘â€ğŸš€ğŸ‘·ğŸ‘®ğŸ•µï¸ğŸ§‘â€âœˆï¸ğŸ§‘â€ğŸ”¬ğŸ§‘â€âš•ï¸ğŸ§‘â€ğŸ”§ğŸ§‘â€ğŸ­ğŸ§‘â€ğŸš’ğŸ§‘â€ğŸŒ¾ğŸ§‘â€ğŸ«ğŸ§‘â€ğŸ“ğŸ§‘â€ğŸ’¼ğŸ§‘â€âš–ï¸ğŸ§‘â€ğŸ’»ğŸ§‘â€ğŸ¤ğŸ§‘â€ğŸ¨ğŸ§‘â€ğŸ³ğŸ‘³ğŸ§•ğŸ‘²ğŸ‘¶ğŸ§’ğŸ§‘ğŸ§“ğŸ§‘â€ğŸ¦³ğŸ§‘â€ğŸ¦°ğŸ‘±ğŸ§‘â€ğŸ¦±ğŸ§‘â€ğŸ¦²ğŸ§”ğŸ•´ï¸ğŸ’ƒğŸ•ºğŸ‘¯ğŸ§‘â€ğŸ¤â€ğŸ§‘ğŸ‘­ğŸ‘¬ğŸ‘«ğŸ’ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘©ğŸ’‘ğŸ‘©â€â¤ï¸â€ğŸ‘¨ğŸ‘¨â€â¤ï¸â€ğŸ‘¨ğŸ‘©â€â¤ï¸â€ğŸ‘©ğŸ«„ğŸ¤±ğŸ§‘â€ğŸ¼ğŸ’ğŸŒ¹ğŸ¥€ğŸŒºğŸŒ·ğŸª·ğŸŒ¸ğŸ’®ğŸµï¸ğŸª»ğŸŒ»ğŸŒ¼ğŸ‚ğŸğŸ„ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸƒâ˜˜ï¸ğŸ€ğŸª´ğŸŒµğŸŒ´ğŸŒ³ğŸŒ²ğŸªµğŸª¹ğŸªºğŸª¨â›°ï¸ğŸ”ï¸â„ï¸â˜ƒï¸â›„ğŸŒ¡ï¸ğŸ”¥ğŸŒ‹ğŸœï¸ğŸï¸ğŸŒ…ğŸŒ„ğŸï¸ğŸ–ï¸ğŸŒˆğŸ«§ğŸŒŠğŸŒ¬ï¸ğŸŒ€ğŸŒªï¸âš¡â˜”ğŸ’§â˜ï¸ğŸŒ¨ï¸ğŸŒ§ï¸ğŸŒ©ï¸â›ˆï¸ğŸŒ¦ï¸ğŸŒ¥ï¸â›…ğŸŒ¤ï¸â˜€ï¸ğŸŒğŸŒğŸŒšğŸŒœğŸŒ›ğŸŒ™â­ğŸŒŸâœ¨ğŸ•³ï¸ğŸªğŸŒğŸŒğŸŒğŸŒ«ï¸ğŸŒ ğŸŒŒâ˜„ï¸ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜ğŸ™ˆğŸ™‰ğŸ™ŠğŸµğŸ¦ğŸ¯ğŸ±ğŸ¶ğŸºğŸ»ğŸ»â€â„ï¸ğŸ¨ğŸ¼ğŸ¹ğŸ­ğŸ°ğŸ¦ŠğŸ¦ğŸ·ğŸ®ğŸ½ğŸ—ğŸ¦“ğŸ¦„ğŸ´ğŸ«ğŸ²ğŸ¦ğŸ‰ğŸ¦–ğŸ¦•ğŸ¢ğŸŠğŸğŸ¸ğŸ‡ğŸğŸ€ğŸˆğŸˆâ€â¬›ğŸ©ğŸ•ğŸ¦®ğŸ•â€ğŸ¦ºğŸ–ğŸğŸ«ğŸ„ğŸ‚ğŸƒğŸ¦¬ğŸğŸ‘ğŸğŸ¦ŒğŸ¦™ğŸ¦¥ğŸ¦˜ğŸ˜ğŸ¦£ğŸ¦ğŸ¦›ğŸ¦’ğŸ†ğŸ…ğŸ’ğŸ¦ğŸ¦§ğŸªğŸ«ğŸ¿ï¸ğŸ¦«ğŸ¦¨ğŸ¦¡ğŸ¦”ğŸ¦¦ğŸ¦‡ğŸª½ğŸª¶ğŸ¦ğŸ¦â€â¬›ğŸ“ğŸ”ğŸ£ğŸ¤ğŸ¥ğŸ¦…ğŸ¦‰ğŸ¦œğŸ•Šï¸ğŸ¦¤ğŸ¦¢ğŸ¦†ğŸª¿ğŸ¦©ğŸ¦šğŸ¦ƒğŸ§ğŸ¦­ğŸ¦ˆğŸ¬ğŸ‹ğŸ³ğŸŸğŸ ğŸ¡ğŸ¦ğŸ¦ğŸ¦€ğŸ¦‘ğŸ™ğŸª¼ğŸ¦ªğŸª¸ğŸ¦‚ğŸ•·ï¸ğŸ•¸ï¸ğŸšğŸŒğŸœğŸ¦—ğŸª²ğŸ¦ŸğŸª³ğŸª°ğŸğŸğŸ¦‹ğŸ›ğŸª±ğŸ¦ ğŸ¾ğŸ“ğŸ’ğŸğŸ…ğŸŒ¶ï¸ğŸ‰ğŸ‘ğŸŠğŸ¥•ğŸ¥­ğŸğŸŒğŸŒ½ğŸ‹ğŸˆğŸğŸ«›ğŸ¥¬ğŸ«‘ğŸğŸ¥ğŸ¥‘ğŸ«’ğŸ¥¦ğŸ¥’ğŸ«ğŸ‡ğŸ†ğŸ ğŸ¥¥ğŸ¥”ğŸ§…ğŸ«šğŸ§„ğŸ«˜ğŸŒ°ğŸ¥œğŸğŸ«“ğŸ¥ğŸ¥–ğŸ¥¯ğŸ§‡ğŸ¥ğŸ³ğŸ¥šğŸ§€ğŸ¥“ğŸ¥©ğŸ—ğŸ–ğŸ”ğŸŒ­ğŸ¥¨ğŸ¥ªğŸŸğŸ•ğŸ«”ğŸŒ®ğŸŒ¯ğŸ¥™ğŸ§†ğŸ¥˜ğŸğŸ¥«ğŸ«•ğŸ¥£ğŸ¥—ğŸ²ğŸ›ğŸœğŸ¦ªğŸ¦ğŸ£ğŸ¤ğŸ¥¡ğŸšğŸ±ğŸ¥ŸğŸ¢ğŸ™ğŸ˜ğŸ¥ğŸ¡ğŸ¥ ğŸ¥®ğŸ§ğŸ¨ğŸ¦ğŸ¥§ğŸ°ğŸ®ğŸ‚ğŸ§ğŸ­ğŸ¬ğŸ«ğŸ©ğŸªğŸ¯ğŸ§‚ğŸ§ˆğŸ¿ğŸ§ŠğŸ«™ğŸ¥¤ğŸ§‹ğŸ§ƒğŸ¥›ğŸ¼ğŸµâ˜•ğŸ«–ğŸ§‰ğŸºğŸ»ğŸ¥‚ğŸ¾ğŸ·ğŸ¥ƒğŸ«—ğŸ¸ğŸ¹ğŸ¶ğŸ¥¢ğŸ´ğŸ¥„ğŸ”ªğŸ½ï¸ğŸ›‘ğŸš§ğŸš¨â›½ğŸ›¢ï¸ğŸ§­ğŸ›ğŸ›Ÿâš“ğŸšğŸš‡ğŸš¥ğŸš¦ğŸ›´ğŸ¦½ğŸ¦¼ğŸ©¼ğŸš²ğŸ›µğŸï¸ğŸš™ğŸš—ğŸ›»ğŸšğŸššğŸš›ğŸšœğŸï¸ğŸš’ğŸš‘ğŸš“ğŸš•ğŸ›ºğŸšŒğŸšˆğŸšğŸš…ğŸš„ğŸš‚ğŸšƒğŸš‹ğŸšğŸšğŸšŠğŸš‰ğŸšğŸš”ğŸš˜ğŸš–ğŸš†ğŸš¢ğŸ›³ï¸ğŸ›¥ï¸ğŸš¤â›´ï¸â›µğŸ›¶ğŸšŸğŸš ğŸš¡ğŸšğŸ›¸ğŸš€âœˆï¸ğŸ›«ğŸ›¬ğŸ›©ï¸ğŸ›ğŸ¢ğŸ¡ğŸ ğŸªğŸ—¼ğŸ—½ğŸ—¿ğŸ—»ğŸ›ï¸ğŸ’ˆâ›²â›©ï¸ğŸ•ğŸ•ŒğŸ•‹ğŸ›•â›ªğŸ’’ğŸ©ğŸ¯ğŸ°ğŸ—ï¸ğŸ¢ğŸ­ğŸªğŸ¬ğŸŸï¸ğŸ¦ğŸ«ğŸ¨ğŸ£ğŸ¤ğŸ¥ğŸšï¸ğŸ ğŸ¡ğŸ˜ï¸ğŸ›–â›ºğŸ•ï¸â›±ï¸ğŸ™ï¸ğŸŒ†ğŸŒ‡ğŸŒƒğŸŒ‰ğŸŒğŸ›¤ï¸ğŸ›£ï¸ğŸ—¾ğŸ—ºï¸ğŸŒğŸ’ºğŸ§³ğŸ‰ğŸŠğŸˆğŸ‚ğŸ€ğŸğŸ‡ğŸ†ğŸ§¨ğŸ§§ğŸª”ğŸª…ğŸª©ğŸğŸğŸğŸ‘ğŸğŸ‹ğŸ„ğŸƒğŸ—ï¸ğŸ¥‡ğŸ¥ˆğŸ¥‰ğŸ…ğŸ–ï¸ğŸ†ğŸ“¢âš½âš¾ğŸ¥ğŸ€ğŸğŸˆğŸ‰ğŸ¥…ğŸ¾ğŸ¸ğŸ¥ğŸğŸ‘ğŸ’ğŸ¥ŒğŸ›·ğŸ¿â›¸ï¸ğŸ›¼ğŸ©°ğŸ›¹â›³ğŸ¯ğŸ¹ğŸ¥ğŸªƒğŸªğŸ£ğŸ¤¿ğŸ©±ğŸ½ğŸ¥‹ğŸ¥ŠğŸ±ğŸ“ğŸ³â™Ÿï¸ğŸª€ğŸ§©ğŸ®ğŸ•¹ï¸ğŸ‘¾ğŸ”«ğŸ²ğŸ°ğŸ´ğŸ€„ğŸƒğŸª„ğŸ©ğŸ“·ğŸ“¸ğŸ–¼ï¸ğŸ¨ğŸ–Œï¸ğŸ–ï¸ğŸª¡ğŸ§µğŸ§¶ğŸ¹ğŸ·ğŸºğŸ¸ğŸª•ğŸ»ğŸª˜ğŸ¥ğŸª‡ğŸªˆğŸª—ğŸ¤ğŸ§ğŸšï¸ğŸ›ï¸ğŸ™ï¸ğŸ“»ğŸ“ºğŸ“¼ğŸ“¹ğŸ“½ï¸ğŸ¥ğŸï¸ğŸ¬ğŸ­ğŸ«ğŸŸï¸ğŸ“±â˜ï¸ğŸ“ğŸ“ŸğŸ“ ğŸ”ŒğŸ”‹ğŸª«ğŸ–²ï¸ğŸ’½ğŸ’¾ğŸ’¿ğŸ“€ğŸ–¥ï¸ğŸ’»âŒ¨ï¸ğŸ–¨ï¸ğŸ–±ï¸ğŸª™ğŸ’¸ğŸ’µğŸ’´ğŸ’¶ğŸ’·ğŸ’³ğŸ’°ğŸ’ğŸ§¾ğŸ§®âš–ï¸ğŸ›’ğŸ›ï¸ğŸ•¯ï¸ğŸ’¡ğŸ”¦ğŸ®ğŸ§±ğŸªŸğŸªğŸšªğŸª‘ğŸ›ï¸ğŸ›‹ï¸ğŸš¿ğŸ›ğŸš½ğŸ§»ğŸª ğŸ§¸ğŸª†ğŸ§·ğŸª¢ğŸ§¹ğŸ§´ğŸ§½ğŸ§¼ğŸª¥ğŸª’ğŸª®ğŸ§ºğŸ§¦ğŸ§¤ğŸ§£ğŸ‘–ğŸ‘•ğŸ½ğŸ‘šğŸ‘”ğŸ‘—ğŸ‘˜ğŸ¥»ğŸ©±ğŸ‘™ğŸ©³ğŸ©²ğŸ§¥ğŸ¥¼ğŸ¦ºâ›‘ï¸ğŸª–ğŸ“ğŸ©ğŸ‘’ğŸ§¢ğŸ‘‘ğŸ’ğŸ’„ğŸª­ğŸ’ğŸ‘ğŸ‘›ğŸ‘œğŸ’¼ğŸ§³â˜‚ï¸ğŸŒ‚ğŸ¥¾ğŸ‘¢ğŸ©´ğŸ‘ ğŸ‘ŸğŸ‘ğŸ¥¿ğŸ‘¡ğŸ¦¯ğŸ•¶ï¸ğŸ‘“ğŸ¥½âš—ï¸ğŸ§«ğŸ§ªğŸŒ¡ï¸ğŸ’‰ğŸ’ŠğŸ©¹ğŸ©ºğŸ©»ğŸ§¬ğŸ”­ğŸ”¬ğŸ“¡ğŸ›°ï¸ğŸ§¯ğŸª“ğŸªœğŸª£ğŸªğŸ§²ğŸ§°ğŸ—œï¸ğŸ”©ğŸª›ğŸªšğŸ”§ğŸ”¨ğŸ› ï¸âš’ï¸â›ï¸âš™ï¸ğŸ”—â›“ï¸ğŸ–‡ï¸ğŸ“âœ‚ï¸ğŸ“ğŸ“ğŸ–Œï¸ğŸ–ï¸ğŸ–Šï¸ğŸ–‹ï¸âœ’ï¸âœï¸ğŸ“ğŸ—’ï¸ğŸ“„ğŸ“ƒğŸ“‘ğŸ“‹ğŸ—ƒï¸ğŸ—„ï¸ğŸ“’ğŸ“”ğŸ“•ğŸ““ğŸ“—ğŸ“˜ğŸ“™ğŸ“šğŸ“–ğŸ”–ğŸ“‚ğŸ“ğŸ—‚ï¸ğŸ“ŠğŸ“ˆğŸ“ˆğŸ“‰ğŸ“‡ğŸªªğŸ“ŒğŸ“ğŸ—‘ï¸ğŸ“°ğŸ—ï¸ğŸ·ï¸ğŸ“¦ğŸ“¤ğŸ“¥ğŸ“¨ğŸ“©âœ‰ï¸ğŸ’ŒğŸ“§ğŸ“«ğŸ“ªğŸ“¬ğŸ“­ğŸ“®ğŸ—³ï¸âŒšğŸ•°ï¸âŒ›â³â²ï¸â°â±ï¸ğŸ•›ğŸ•§ğŸ•ğŸ•œğŸ•‘ğŸ•ğŸ•’ğŸ•ğŸ•“ğŸ•ŸğŸ•”ğŸ• ğŸ••ğŸ•¡ğŸ•¢ğŸ•–ğŸ•—ğŸ•£ğŸ•˜ğŸ•¤ğŸ•™ğŸ•¥ğŸ•šğŸ•¦ğŸ“…ğŸ“†ğŸ—“ï¸ğŸª§ğŸ›ï¸ğŸ””ğŸ“¯ğŸ“¢ğŸ“£ğŸ”ˆğŸ”‰ğŸ”ŠğŸ”ğŸ”ğŸ”®ğŸ§¿ğŸª¬ğŸ“¿ğŸºâš±ï¸âš°ï¸ğŸª¦ğŸš¬ğŸ’£ğŸª¤ğŸ“œâš”ï¸ğŸ—¡ï¸ğŸ›¡ï¸ğŸ—ï¸ğŸ”‘ğŸ”ğŸ”ğŸ”’ğŸ”“ğŸ”´ğŸŸ ğŸŸ¡ğŸŸ¢ğŸ”µğŸŸ£ğŸŸ¤âš«âšªğŸŸ¥ğŸŸ§ğŸŸ¨ğŸŸ©ğŸŸ¦ğŸŸªğŸŸ«â¬›â¬œâ¤ï¸ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ¤ğŸ–¤ğŸ¤ğŸ©·ğŸ©µğŸ©¶â™¥ï¸â™¦ï¸â™£ï¸â™ ï¸â™ˆâ™‰â™Šâ™‹â™Œâ™â™â™â™â™‘â™’â™“â›â™€ï¸â™‚ï¸âš§ï¸ğŸ’­ğŸ—¯ï¸ğŸ’¬ğŸ—¨ï¸â•â”â—â“â‰ï¸â€¼ï¸â­•âŒğŸš«ğŸš³ğŸš­ğŸš¯ğŸš±ğŸš·ğŸ“µğŸ”ğŸ”•ğŸ”‡ğŸ…°ï¸ğŸ†ğŸ…±ï¸ğŸ…¾ï¸ğŸ†‘ğŸ†˜ğŸ›‘â›”ğŸ“›â™¨ï¸ğŸ”»ğŸ”ºğŸ“¶ğŸ†šğŸ¦âœ´ï¸ğŸ”¶ğŸ”¸ğŸ”†ğŸ”…ğŸ”ğŸ”‚ğŸ”€â–¶ï¸â©â­ï¸â¯ï¸â—€ï¸âªâ®ï¸ğŸ”¼â«ğŸ”½â¬â¸ï¸â¹ï¸âºï¸âï¸ğŸ“´ğŸ›œğŸ“³ğŸ“²â˜¢ï¸â˜£ï¸âš ï¸ğŸš¸âšœï¸ğŸ”±ã€½ï¸ğŸ”°âœ³ï¸â‡ï¸â™»ï¸ğŸ’±ğŸ’²ğŸ’¹ğŸˆ¯ââœ…âœ”ï¸â˜‘ï¸â¬†ï¸â†—ï¸â¡ï¸â†˜ï¸â¬‡ï¸â†™ï¸â¬…ï¸â†–ï¸â†•ï¸â†”ï¸â†©ï¸â†ªï¸â¤´ï¸â¤µï¸ğŸ”ƒğŸ”„ğŸ”™ğŸ”›ğŸ”ğŸ”šğŸ”œğŸ†•ğŸ†“ğŸ†™ğŸ†—ğŸ†’ğŸ†–â„¹ï¸ğŸ…¿ï¸ğŸˆğŸ”¤ğŸ” ğŸ”¡ğŸ”¢#ï¸âƒ£*ï¸âƒ£0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£3ï¸âƒ£4ï¸âƒ£5ï¸âƒ£6ï¸âƒ£7ï¸âƒ£8ï¸âƒ£9ï¸âƒ£ğŸ”ŸğŸŒğŸ’ ğŸ”·ğŸ”¹ğŸ§â“‚ï¸ğŸš¾ğŸš»ğŸš¹â™¿ğŸšºğŸš¼ğŸ›—ğŸš®ğŸš°ğŸ›‚ğŸ›ƒğŸ›„ğŸ›…ğŸ’Ÿâš›ï¸ğŸ›ğŸ•‰ï¸â˜¸ï¸â˜®ï¸â˜¯ï¸â˜ªï¸ğŸª¯âœï¸â˜¦ï¸âœ¡ï¸ğŸ”¯ğŸ•â™¾ï¸ğŸ†”âš•ï¸ğŸ¼ğŸµğŸ¶âœ–ï¸â•â–â—ğŸŸ°â°â¿ã€°ï¸Â©ï¸Â®ï¸â„¢ï¸ğŸ”˜ğŸ”³â—¼ï¸â—¾â–ªï¸ğŸ”²â—»ï¸â—½â–«ï¸ğŸ‘ï¸â€ğŸ—¨ï¸ğŸğŸš©ğŸŒğŸ´ğŸ³ï¸ğŸ³ï¸â€ğŸŒˆğŸ³ï¸â€âš§ï¸ğŸ´â€â˜ ï¸ğŸ‡¦ğŸ‡¨ğŸ‡¦ğŸ‡©ğŸ‡¦ğŸ‡ªğŸ‡¦ğŸ‡«ğŸ‡¦ğŸ‡¬ğŸ‡¦ğŸ‡®ğŸ‡¦ğŸ‡±ğŸ‡¦ğŸ‡²ğŸ‡¦ğŸ‡´ğŸ‡¦ğŸ‡¶ğŸ‡¦ğŸ‡·ğŸ‡¦ğŸ‡¸ğŸ‡¦ğŸ‡¹ğŸ‡¦ğŸ‡ºğŸ‡¦ğŸ‡¼ğŸ‡¦ğŸ‡½ğŸ‡¦ğŸ‡¿ğŸ‡§ğŸ‡¦ğŸ‡§ğŸ‡§ğŸ‡§ğŸ‡©ğŸ‡§ğŸ‡ªğŸ‡§ğŸ‡«ğŸ‡§ğŸ‡¬ğŸ‡§ğŸ‡­ğŸ‡§ğŸ‡®ğŸ‡§ğŸ‡±ğŸ‡§ğŸ‡²ğŸ‡§ğŸ‡³ğŸ‡§ğŸ‡´ğŸ‡§ğŸ‡¶ğŸ‡§ğŸ‡·ğŸ‡§ğŸ‡¸ğŸ‡§ğŸ‡¹ğŸ‡§ğŸ‡»ğŸ‡§ğŸ‡¼ğŸ‡§ğŸ‡¾ğŸ‡§ğŸ‡¿ğŸ‡¨ğŸ‡¦ğŸ‡¨ğŸ‡¨ğŸ‡¨ğŸ‡©ğŸ‡¨ğŸ‡«ğŸ‡¨ğŸ‡¬ğŸ‡¨ğŸ‡­ğŸ‡¨ğŸ‡®ğŸ‡¨ğŸ‡°ğŸ‡¨ğŸ‡±ğŸ‡¨ğŸ‡²ğŸ‡¨ğŸ‡³ğŸ‡¨ğŸ‡´ğŸ‡¨ğŸ‡µğŸ‡¨ğŸ‡·ğŸ‡¨ğŸ‡ºğŸ‡¨ğŸ‡»ğŸ‡¨ğŸ‡¼ğŸ‡¨ğŸ‡½ğŸ‡¨ğŸ‡¾ğŸ‡¨ğŸ‡¿ğŸ‡©ğŸ‡ªğŸ‡©ğŸ‡¬ğŸ‡©ğŸ‡°ğŸ‡©ğŸ‡¯ğŸ‡©ğŸ‡²ğŸ‡©ğŸ‡´ğŸ‡©ğŸ‡¿ğŸ‡ªğŸ‡¦ğŸ‡ªğŸ‡¨ğŸ‡ªğŸ‡ªğŸ‡ªğŸ‡¬ğŸ‡ªğŸ‡­ğŸ‡ªğŸ‡·ğŸ‡ªğŸ‡¸ğŸ‡ªğŸ‡¹ğŸ‡ªğŸ‡ºğŸ‡«ğŸ‡®ğŸ‡«ğŸ‡¯ğŸ‡«ğŸ‡°ğŸ‡«ğŸ‡²ğŸ‡«ğŸ‡´ğŸ‡«ğŸ‡·ğŸ‡¬ğŸ‡¦ğŸ‡¬ğŸ‡§ğŸ‡¬ğŸ‡©ğŸ‡¬ğŸ‡ªğŸ‡¬ğŸ‡«ğŸ‡¬ğŸ‡¬ğŸ‡¬ğŸ‡­ğŸ‡¬ğŸ‡®ğŸ‡¬ğŸ‡±ğŸ‡¬ğŸ‡²ğŸ‡¬ğŸ‡³ğŸ‡¬ğŸ‡µğŸ‡¬ğŸ‡¶ğŸ‡¬ğŸ‡·ğŸ‡¬ğŸ‡¸ğŸ‡¬ğŸ‡¹ğŸ‡¬ğŸ‡ºğŸ‡¬ğŸ‡¼ğŸ‡¬ğŸ‡¾ğŸ‡­ğŸ‡°ğŸ‡­ğŸ‡²ğŸ‡­ğŸ‡³ğŸ‡­ğŸ‡·ğŸ‡­ğŸ‡¹ğŸ‡­ğŸ‡ºğŸ‡®ğŸ‡¨ğŸ‡®ğŸ‡©ğŸ‡®ğŸ‡ªğŸ‡®ğŸ‡±ğŸ‡®ğŸ‡²ğŸ‡®ğŸ‡³ğŸ‡®ğŸ‡´ğŸ‡®ğŸ‡¶ğŸ‡®ğŸ‡·ğŸ‡®ğŸ‡¸ğŸ‡®ğŸ‡¹ğŸ‡¯ğŸ‡ªğŸ‡¯ğŸ‡²ğŸ‡¯ğŸ‡´ğŸ‡¯ğŸ‡µğŸ‡°ğŸ‡ªğŸ‡°ğŸ‡¬ğŸ‡°ğŸ‡­ğŸ‡°ğŸ‡®ğŸ‡°ğŸ‡²ğŸ‡°ğŸ‡³ğŸ‡°ğŸ‡µğŸ‡°ğŸ‡·ğŸ‡°ğŸ‡¼ğŸ‡°ğŸ‡¾ğŸ‡°ğŸ‡¿ğŸ‡±ğŸ‡¦ğŸ‡±ğŸ‡§ğŸ‡±ğŸ‡¨ğŸ‡±ğŸ‡®ğŸ‡±ğŸ‡°ğŸ‡±ğŸ‡·ğŸ‡±ğŸ‡¸ğŸ‡±ğŸ‡ºğŸ‡±ğŸ‡¹ğŸ‡±ğŸ‡»ğŸ‡±ğŸ‡¾ğŸ‡²ğŸ‡¦ğŸ‡²ğŸ‡¨ğŸ‡²ğŸ‡©ğŸ‡²ğŸ‡ªğŸ‡²ğŸ‡«ğŸ‡²ğŸ‡¬ğŸ‡²ğŸ‡­ğŸ‡²ğŸ‡°ğŸ‡²ğŸ‡±ğŸ‡²ğŸ‡²ğŸ‡²ğŸ‡²ğŸ‡²ğŸ‡³ğŸ‡²ğŸ‡´ğŸ‡²ğŸ‡µğŸ‡²ğŸ‡¶ğŸ‡²ğŸ‡·ğŸ‡²ğŸ‡¸ğŸ‡²ğŸ‡¹ğŸ‡²ğŸ‡ºğŸ‡²ğŸ‡»ğŸ‡²ğŸ‡¼ğŸ‡²ğŸ‡½ğŸ‡²ğŸ‡¾ğŸ‡³ğŸ‡¦ğŸ‡²ğŸ‡¿ğŸ‡³ğŸ‡¨ğŸ‡³ğŸ‡ªğŸ‡³ğŸ‡«ğŸ‡³ğŸ‡¬ğŸ‡³ğŸ‡®ğŸ‡³ğŸ‡±ğŸ‡³ğŸ‡´ğŸ‡³ğŸ‡µğŸ‡³ğŸ‡·ğŸ‡³ğŸ‡ºğŸ‡³ğŸ‡¿ğŸ‡´ğŸ‡²ğŸ‡µğŸ‡¦ğŸ‡µğŸ‡ªğŸ‡µğŸ‡«ğŸ‡µğŸ‡¬ğŸ‡µğŸ‡­ğŸ‡µğŸ‡°ğŸ‡µğŸ‡±ğŸ‡µğŸ‡²ğŸ‡µğŸ‡³ğŸ‡µğŸ‡·ğŸ‡µğŸ‡¸ğŸ‡µğŸ‡¹ğŸ‡µğŸ‡¼ğŸ‡µğŸ‡¾ğŸ‡¶ğŸ‡¦ğŸ‡·ğŸ‡ªğŸ‡·ğŸ‡´ğŸ‡·ğŸ‡¸ğŸ‡·ğŸ‡ºğŸ‡·ğŸ‡¼ğŸ‡¸ğŸ‡¦ğŸ‡¸ğŸ‡§ğŸ‡¸ğŸ‡¨ğŸ‡¸ğŸ‡©ğŸ‡¸ğŸ‡ªğŸ‡¸ğŸ‡¬ğŸ‡¸ğŸ‡­ğŸ‡¸ğŸ‡®ğŸ‡¸ğŸ‡¯ğŸ‡¸ğŸ‡°ğŸ‡¸ğŸ‡±ğŸ‡¸ğŸ‡²ğŸ‡¸ğŸ‡³ğŸ‡¸ğŸ‡´ğŸ‡¸ğŸ‡·ğŸ‡¸ğŸ‡¹ğŸ‡¸ğŸ‡¹ğŸ‡¸ğŸ‡¸ğŸ‡¸ğŸ‡»ğŸ‡¸ğŸ‡½ğŸ‡¸ğŸ‡¾ğŸ‡¸ğŸ‡¿ğŸ‡¹ğŸ‡¦ğŸ‡¹ğŸ‡¨ğŸ‡¹ğŸ‡©ğŸ‡¹ğŸ‡«ğŸ‡¹ğŸ‡¬ğŸ‡¹ğŸ‡­ğŸ‡¹ğŸ‡¯ğŸ‡¹ğŸ‡°ğŸ‡¹ğŸ‡±ğŸ‡¹ğŸ‡²ğŸ‡¹ğŸ‡³ğŸ‡¹ğŸ‡´ğŸ‡¹ğŸ‡·ğŸ‡¹ğŸ‡¹ğŸ‡¹ğŸ‡»ğŸ‡¹ğŸ‡¼ğŸ‡¹ğŸ‡¿ğŸ‡ºğŸ‡¦ğŸ‡ºğŸ‡¬ğŸ‡ºğŸ‡²ğŸ‡ºğŸ‡³ğŸ‡ºğŸ‡¸ğŸ‡ºğŸ‡¾ğŸ‡ºğŸ‡¿ğŸ‡»ğŸ‡¦ğŸ‡»ğŸ‡¨ğŸ‡»ğŸ‡ªğŸ‡»ğŸ‡¬ğŸ‡»ğŸ‡®ğŸ‡»ğŸ‡³ğŸ‡»ğŸ‡ºğŸ‡¼ğŸ‡«ğŸ‡¼ğŸ‡¸ğŸ‡½ğŸ‡°ğŸ‡¾ğŸ‡ªğŸ‡¾ğŸ‡¹ğŸ‡¿ğŸ‡¦ğŸ‡¿ğŸ‡²ğŸ‡¿ğŸ‡¼ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿ğŸ´ó §ó ¢ó ·ó ¬ó ³ó ¿"
   /* private val EMOTICONS = arrayOf(
        "ğŸ™", "ğŸ–•", "ğŸ‘‡", "ğŸ‘†", "â˜ï¸", "ğŸ‘ˆ", "ğŸ‘‰", "ğŸ«µ", "ğŸ‘Œ", "ğŸ¤", 
        "ğŸ¤Œ", "ğŸ¤™", "ğŸ«°", "ğŸ¤", "âœŒï¸", "ğŸ¤˜", "ğŸ¤Ÿ", "ğŸ––", "âœ‹", "ğŸ–ï¸", 
        "ğŸ¤š", "ğŸ‘‹", "ğŸ«·", "ğŸ«¸", "ğŸ«²", "ğŸ«±", "ğŸ«´", "ğŸ«³", "ğŸ‘Š", "âœŠ", 
        "ğŸ¤›", "ğŸ¤œ", "ğŸ¤²", "ğŸ‘", "ğŸ™Œ", "ğŸ«¶", "ğŸ‘", "ğŸ‘", "ğŸ‘", "ğŸ’ª", 
        "ğŸ‘ƒ", "ğŸ‘‚", "ğŸ¦»", "ğŸ¦¶", "ğŸ¦µ"
    )
      */
	
    companion object {
        const val WIDGET_CLICK_ACTION = "dev.kelvinwilliams.PRE.WIDGET_CLICK" 
    }

	// --- SHUFFLE LOGIC REINSTATED ---
    private fun getShuffledEmoticon(): String {
        // val tempArray = EMOTICONS.toMutableList()
		val tempArray = text.map { it.toString() } 
        // Shuffle multiple times as you requested for better randomness
        val numShuffles: Int = Random.nextInt(2, 6) 
        repeat(numShuffles) {
            tempArray.shuffle()
        }
        return tempArray.random()
	}

	private fun getRandomEmoticon(): String {
		/*
        val ranges = listOf(
            0x0023..0x0023,   // Number Sign (#)
            0x002A..0x002A,   // Asterisk (*)
            0x0030..0x0039,   // Digits 0-9
            0x2600..0x26FF,   // Miscellaneous Symbols
            0x2700..0x27BF,   // Dingbats
            0x1F100..0x1F1FF, // Enclosed Alphanumeric Supplement
            0x1F300..0x1F5FF, // Misc Symbols and Pictographs
            0x1F600..0x1F64F, // Emoticons (Smileys)
            0x1F680..0x1F6FF, // Transport and Map Symbols
            0x1F900..0x1F9FF, // Supplemental Symbols and Pictographs
            0x1FA70..0x1FAFF  // Symbols and Pictographs Extended-A
        )

        // Select a random range from the list
        val randomRange = ranges.random()
        
        // Select a random integer value within that range
        val randomValue = kotlin.random.Random.nextInt(randomRange.first, randomRange.last + 1)
		*/
		val oneRange = (0x0023..0x1FAFF).toList()
		val randomizedRange = oneRange.shuffled()
		val random = kotlin.random.Random.nextInt(0, randomizedRange.size + 1)
		val randomValue = randomizedRange[random]
        // Convert the Unicode code point to a String
        return String(Character.toChars(randomValue))
	}
    // --- WIDGET UPDATE METHOD ---
    internal fun updateAppWidget(
        context: Context,
        appWidgetManager: AppWidgetManager,
        appWidgetId: Int
    ) {
        val views = RemoteViews(context.packageName, R.layout.widget_layout)

        val currentEmoticon = getShuffledEmoticon()
		// val currentEmoticon = getRandomEmoticon()
        // val currentEmoticon = EMOTICONS.random()
        views.setTextViewText(R.id.emoticon_text_view, currentEmoticon)

			
	    val mic: Int = kotlin.random.Random.nextInt(0,3)
		views.setTextViewText(R.id.mic_text_view, "âŒ")
        if (mic == 2) {
               views.setTextViewText(R.id.mic_text_view, "â™¾ï¸")
		}

        val intent = Intent(context, EmoticonAppWidget::class.java).apply {
            action = WIDGET_CLICK_ACTION
            data = android.net.Uri.parse("widget://" + appWidgetId)
        }

        val pendingIntent: PendingIntent = PendingIntent.getBroadcast(
            context, 
            appWidgetId, 
            intent,
            PendingIntent.FLAG_UPDATE_CURRENT or PendingIntent.FLAG_IMMUTABLE 
        )

        views.setOnClickPendingIntent(R.id.widget_root_layout, pendingIntent)

        appWidgetManager.updateAppWidget(appWidgetId, views)
    } // <--- CORRECT CLOSING BRACE PLACED HERE

    // --- APPWIDGETPROVIDER OVERRIDES ---

    override fun onUpdate(
        context: Context,
        appWidgetManager: AppWidgetManager,
        appWidgetIds: IntArray
    ) {
        for (appWidgetId in appWidgetIds) {
            updateAppWidget(context, appWidgetManager, appWidgetId)
        }
    }

    override fun onReceive(context: Context, intent: Intent) {
        super.onReceive(context, intent)

        if (WIDGET_CLICK_ACTION == intent.action) {
            Log.d("Widget", "Emoticon widget clicked!")

            val appWidgetManager = AppWidgetManager.getInstance(context)
            val appWidgetIds = appWidgetManager.getAppWidgetIds(
                intent.component
            )
            onUpdate(context, appWidgetManager, appWidgetIds)
        }
    }
}
